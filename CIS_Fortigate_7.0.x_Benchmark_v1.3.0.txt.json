[
    {
        "title": "1.1 Ensure DNS server is configured (Automated) ",
        "description": "Fortinet uses the Domain Name Service (DNS) to translate host names into IP addresses. To enable DNS lookups, you must specify the primary DNS server for your system. You can also specify secondary and tertiary DNS servers. When resolving host names, the system consults the primary name server. If a failure or time-out occurs, the system consults the secondary name server. For security purpose, trusted DNS servers should be configured to prevent man-in-the-middle attacks.  ",
        "audit": "In CLI: FGT1 # config system dns FGT1 (dns) # show config system dns     set primary <ip_address>     set secondary <ip_address>     ... end In the GUI, go to Networks > DNS. The Fortigate uses either the default FortiGuard DNS or customized DNS  ",
        "recommendations": "In this example, we will assign 208.67.222.222 as primary DNS and 208.67.220.220 as secondary DNS. In CLI: FGT1 # config system dns FGT1 (dns) # set primary 208.67.222.222 FGT1 (dns) # set secondary 208.67.220.220 FGT1 (dns) # end FGT1 # In the GUI, go to Networks > DNS. Click on \"Specify\" and put in 208.67.222.222 as \"Primary DNS Server\" and 208.67.220.220 as \"Secondary DNS Server\" Page 14 Default Value: Default primary DNS server is 96.45.45.45. Default secondary DNS server is 96.45.46.46.  "
    },
    {
        "title": "1.2 Ensure intra-zone traffic is not always allowed (Manual) ",
        "description": "This is to make sure that only specific, authorized traffic is allowed between networks in the same zone.  ",
        "audit": "In this example, we'll verify the zone DMZ. In CLI: FGT1 # config system zone FGT1 (zone) # edit DMZ FGT1 (DMZ) # show full config system zone     edit \"DMZ\"         ...         set intrazone deny         ...     next end In the GUI, click on Network -> Interfaces, select the zone and click on \"Edit\". Make sure that the option \"Block intra-zone traffic\" is enabled.  ",
        "recommendations": "In this example, we'll turn off intra-zone traffic in the zone DMZ. In CLI: FGT1 # config system zone FGT1 (zone) # edit DMZ FGT1 (DMZ) # set intrazone deny FGT1 (DMZ) # end FGT1 # In the GUI, click on Network -> Interfaces, select the zone and click on \"Edit\" and turn on \"Block intra-zone traffic\" Default Value: By default, intra-zone traffic is blocked Page 16  "
    },
    {
        "title": "1.3 Disable all management related services on WAN port ",
        "description": "Enabling any management related services on WAN interface is high risk. Management related services such as HTTPS, HTTP, ping, SSH, SNMP, and Radius should be disabled on WAN.  ",
        "audit": "On GUI: Go to \"Network\" > \"Interfaces\". Identify WAN interface and validate that HTTPS, HTTP, PING, SSH, SNMP, and Radius Accounting is not enabled in \"Administrative Access\" section. On CLI: `FGT1 # show system interface` Identify WAN interface and validate that \"set allowaccess\" does not have ping, https, http, ssh, snmp or radius-acct configured.  ",
        "recommendations": "On GUI: Go to \"Network\" > \"Interfaces\". Review WAN interface and disable HTTPS, HTTP, ping, SSH, SNMP, and Radius services. On CLI: Page 18 FGT1 # config system interface FGT1 (interface) # edit \"port1\" FGT1 (port1) # unselect allowaccess ping https ssh snmp http radius-acct Note: 1. Interface name may differ based on deployment. For this example, port1 is deployed as WAN interface. 2. \"unselect allowaccess\" will only show services that you have enabled. If you have not enabled snmp on that interface, then snmp option will not be available.  "
    },
    {
        "title": "2.1.1 Ensure 'Pre-Login Banner' is set (Automated) ",
        "description": "Configure a pre-login banner, ideally approved by the organization\u2019s legal team. This banner should, at minimum, prohibit unauthorized access, provide notice of logging or monitoring, and avoid using the word \u201cwelcome\u201d or similar words of invitation.  ",
        "audit": "Run the following command in the CLI to verify the pre-login-banner is enabled: FG1 # get system global  ...  pre-login-banner    : enable  ... end In the GUI, to verify the content of the pre-login disclaimer message: 1) Go to 'System' -> 'Replacement Messages' 2) From the top right side, select 'Extended View' 3) Find 'Pre-login Disclaimer Message'  ",
        "recommendations": "Run the following command in the CLI to enable the pre-login-banner: FG1 # config system global FG1 (global) # set pre-login-banner enable FG1 (global) # end FG1 # In the GUI, to edit the content of the pre-login disclaimer message: Page 22 1. Go to 'System' -> 'Replacement Messages' -> 'Extended View' -> 'Pre-login Disclaimer Message'. The edit screen is on the bottom right corner of the page. Click on \"Save\" after the editing is done. Default Value: the 'Pre-Login Banner' is disabled by default FG1 # config system global FG1 (global) # show config system global  ...  set pre-login-banner disable  ... end the warning message default value is as follows: PRE WARNING: This is a private computer system. Unauthorized access or use  is prohibited and subject to prosecution and/or disciplinary  action. All use of this system constitutes consent to  monitoring at all times and users are not entitled to any  expectation of privacy. If monitoring reveals possible evidence of violation of criminal statutes, this evidence and any other  related information, including identification information about  the user, may be provided to law enforcement officials. If monitoring reveals violations of security regulations or unauthorized use, employees who violate security regulations or make unauthorized use of this system are subject to appropriate  disciplinary action.  "
    },
    {
        "title": "2.1.2 Ensure 'Post-Login-Banner' is set (Automated) ",
        "description": "Sets the banner after users successfully log in. This is equivalent to Message of the Day (MOTD) in some other systems.  ",
        "audit": "Run the following command in the CLI to verify the post-login-banner is enabled: FG1 # get system global  ...  post-login-banner    : enable  ... In the GUI, to verify the content of the post-login disclaimer message: 1) Go to 'System' -> 'Replacement Messages' 2) From the top right side, select 'Extended View' 3) Find 'Post-login Disclaimer Message'  ",
        "recommendations": "Run the following command in the CLI to enable the post-login-banner: FG1 # config system global FG1 (global) # set post-login-banner enable FG1 (global) # end FG1 # In the GUI, to edit the content of the post-login disclaimer message, go to Page 25 System -> Replace Messages -> Extended View -> \"Post-login Disclaimer Message\". The edit screen is on the bottom right corner of the page. Click on \"Save\" after the editing is done. Default Value: POST WARNING: This is a private computer system. Unauthorized access or use is prohibited and subject to prosecution and/or disciplinary action. All use of this system constitutes consent to monitoring at all times and users are not entitled to any expectation of privacy. If monitoring reveals possible evidence of violation of criminal statutes, this evidence and any other related information, including identification information about the user, may be provided to law enforcement officials. If monitoring reveals violations of security regulations or unauthorized use, employees who violate security regulations or make unauthorized use of this system are subject to appropriate disciplinary action. %%LAST_SUCCESSFUL_LOGIN%% %%LAST_FAILED_LOGIN%%  "
    },
    {
        "title": "2.1.3 Ensure timezone is properly configured (Manual) ",
        "description": "Sets the local time zone information so that the time displayed by the device is more relevant to those who are viewing it.  ",
        "audit": "In the CLI, do the following command and check the result of timezone filed in the output FGT1 # get system global ... timezone            : (GMT-8:00) Pacific Time (US & Canada) ... Or from GUI, do the following: 1) Login to FortiGate 2) Go to 'System' -> 'Settings'. 3) Time Zone and NTP settings are under 'System Time'  ",
        "recommendations": "In this example, we will set Eastern Timezone (GMT-5:00) for the Fortigate. Each timezone will have its corresponding ID. To find the correct ID, when you type in the command \"set timezone \", also type the question mark '?' to list all of the available timezones and their IDs. The ID of the Eastern Timezone is 12 In the CLI: Page 27 FGT1 # config system global FGT1 (global) # set timezone 12 FGT1 (global) # end FGT1 # In the GUI, do the following: 1) After login to fortigate, go to 'System' -> 'Settings' 2) Select '(GMT-5:00) Eastern Time (US & Canada)' under 'System Time' Default Value: Default value is (GMT-8:00) Pacific Time (US & Canada)  "
    },
    {
        "title": "2.1.4 Ensure correct system time is configured through NTP ",
        "description": "You can either manually set the FortiOS system time, or configure the device to automatically keep its system time correct by synchronizing with a Network Time Protocol (NTP) server. These settings enable the use of primary and secondary NTP servers to provide redundancy in case of a failure involving the primary NTP server.  ",
        "audit": "In the CLI: Page 29 FGT1 # diag sys ntp status synchronized: yes, ntpsync: enabled, server-mode: enabled ipv4 server(ntp2.fortiguard.com) 208.91.114.23 -- reachable(0xff) S:3 T:54     server-version=4, stratum=1     reference time is e12361d5.f27e0322 -- UTC Wed Sep 11 12:06:45 2019     clock offset is -0.001569 sec, root delay is 0.000000 sec     root dispersion is 0.010269 sec, peer dispersion is 19 msec ipv4 server(ntp1.fortiguard.com) 208.91.115.123 -- reachable(0xff) S:3 T:54 selected     server-version=4, stratum=1     reference time is e12361d4.4f8b22a5 -- UTC Wed Sep 11 12:06:44 2019     clock offset is -0.000652 sec, root delay is 0.000000 sec     root dispersion is 0.010284 sec, peer dispersion is 8 msec ipv4 server(ntp2.fortiguard.com) 208.91.113.71 -- reachable(0xff) S:3 T:54     server-version=4, stratum=2     reference time is e12361d6.4caf57ab -- UTC Wed Sep 11 12:06:46 2019     clock offset is -0.004814 sec, root delay is 0.000137 sec     root dispersion is 0.011154 sec, peer dispersion is 3 msec ipv4 server(ntp1.fortiguard.com) 208.91.113.70 -- reachable(0xff) S:3 T:54     server-version=4, stratum=2     reference time is e123617b.c98e2059 -- UTC Wed Sep 11 12:05:15 2019     clock offset is -0.005106 sec, root delay is 0.000122 sec     root dispersion is 0.013382 sec, peer dispersion is 6 msec  ",
        "recommendations": "You can only customize NTP setting using CLI. In this example, we'll assign pool.ntp.org as primary NTP server and 1.1.1.1 as secondary NTP server. FGT1 # config system ntp FGT1 (ntp) # set type custom FGT1 (ntp) # config ntpserver FGT1 (ntpserver) # edit 1 FGT1 (1) # set server pool.ntp.org FGT1 (1) # next FGT1 (ntpserver) # edit 2 FGT1 (2) # set server 1.1.1.1 FGT1 (2) # end FGT1 (ntp) # end FGT1 # Default Value: By default, Fortinet uses the NTPs server of the FortiGuard  "
    },
    {
        "title": "2.1.5 Ensure hostname is set (Automated) ",
        "description": "Changes the device default hostname.  ",
        "audit": "In CLI get system global  ...  hostname            : FG1  ... In GUI 1) Go to 'System' > 'Settings' 2) Check the field 'Hostname'  ",
        "recommendations": "In CLI, set the hostname to 'New_FGT1' as follows: FGT1 # config system global FGT1 (global) # set hostname \"New_FGT1\" FGT1 (global) # end New_FGT1 # In GUI 1) Go to 'System' > 'Settings' 2) Update the field 'Hostname' with the new hostname 3) click 'Apply' Default Value: The default value of the hostname is the model number of the unit. Example: 'FortiGate 2000E'  "
    },
    {
        "title": "2.1.6 Ensure the latest firmware is installed (Manual) ",
        "description": "Check against the Fortinet website to make sure that the latest stable firmware is installed.  ",
        "audit": "First, check for the latest firmware version available by going to https://docs.fortinet.com/upgrade-tool, select your product from the Current Product drop-down menu, then select the upgrade to FortiOS Version for the latest available version. Second, verify the current firmware on your system. In the CLI: FGT1 # get system status ... Version: Fortigate-100D v6.2.7,build1190,201216 (GA) ... FGT1 # In the GUI: 1. Go to Dashboard > Status > System information 2. Check for firmware. At the same time, go to https://www.fortiguard.com/psirt?product=FortiOS and check for vulnerabilities that your existing version might have. https://docs.fortinet.com/upgrade-toolhttps://www.fortiguard.com/psirt?product=FortiOSPage 34  ",
        "recommendations": "First, determine the upgrade path recommended by Fortinet. If you have not upgraded the system for a long time, it is not recommended to upgrade straight to the latest version, as the configuration could be lost. Fortinet provides a tool to recommend an upgrade path for all of its products. Go to https://docs.fortinet.com/upgrade-tool. Choose your product from the \"Current Product\" drop-down menu, the \"current FortiOS version\", and the latest firmware version available for that model from \"Upgrade to FortiOS Version\". Click \"Go\". Write down the path and then click on \"Download\" to download all the necessary versions. The second step is to download the required FortiOS firmware/s. Go to https://support.fortinet.com and login. Go to Support -> Firmware Download. Once there, select the product and click on \"Upgrade Path\". Choose the specific model of the hardware, the current firmware version and the latest firmware version available for that model. Click \"Go\". Write down the path and then click on \"Download\" to download all the necessary versions. The last step is to install the new firmwares in the order provided by the \"Upgrade tool\". It is recommended to use GUI to perform this task as it would be much easier. In the GUI 1. Go to System > Fabric Management 2. Right click on device that needs to be upgraded. 3. Then click on \"Upgrade\". You might have to perform this step multiple times if you follow the upgrade path. Default Value: There is no default firmware. The hardware comes with the latest firmware at the time it was manufactured.  "
    },
    {
        "title": "2.1.7 Disable USB Firmware and configuration installation ",
        "description": "Disable USB port auto install feature for config and firmware.  ",
        "audit": "CLI: config system auto-install get  Verify that set auto-install-config and set auto-install-image are disabled  ",
        "recommendations": "CLI: config system auto-install     set auto-install-config disable     set auto-install-image disable end Default Value: auto-install is disabled by default on 7.2.x. However, upgrading from earlier version to FortiOS 7.2.x will have auto-install values set as \"enable\".  "
    },
    {
        "title": "2.1.8 Disable static keys for TLS (Automated) ",
        "description": "Disable support for static keys on TLS sessions terminating on the FortiGate  ",
        "audit": "CLI: config system global get Validate that ssl-static-key-ciphers disabled.  ",
        "recommendations": "CLI: config system global set ssl-static-key-ciphers disable end Default Value: ssl-static-key-ciphers is enabled  "
    },
    {
        "title": "2.1.9 Enable Global Strong Encryption (Automated) ",
        "description": "Enable FortiOS to only use strong encryption and allow only strong ciphers for communication  ",
        "audit": "CLI: config system global get Validate strong-crypto is enabled.  ",
        "recommendations": "CLI: config system global set strong-crypto enable end Default Value: strong-crypto is enabled by default.  "
    },
    {
        "title": "2.1.10 Ensure management GUI listens on secure TLS version ",
        "description": "As we move towards better encryption capabilities, we need to also ensure GUI access is properly secured. TLS 1.3 is currently the most secure SSL/TLS supported version for SSL-encrypted administrator access (at this time of writing).  ",
        "audit": "CLI: config system global get Verify if set admin-https-ssl-versions tlsv1-3 is configured.  ",
        "recommendations": "CLI: config system global set admin-https-ssl-versions tlsv1-3 Default Value: FortiOS 7.x - TLS 1.2 and 1.3 enabled FortiOS 6.x - TLS 1.1, 1.2, and 1.3 enabled  "
    },
    {
        "title": "2.1.11 Ensure CDN is enabled for improved GUI performance ",
        "description": "To improve GUI performance, an option is added to enable loading static GUI artifacts cached in CDN (content delivery network) servers closer to the user rather than from the FortiGate. On failure, the files can fall back to loading from the FortiGate.  ",
        "audit": "On CLI: config system global  get Ensure that gui-cdn-usage is enabled.  ",
        "recommendations": "On CLI: config system global     set gui-cdn-usage enable end Default Value: Disabled  "
    },
    {
        "title": "2.1.12 Ensure single CPU core overloaded event is logged ",
        "description": "Add log-single-cpu-high option under config system global. When enabled, CPU single core usage will be polled every three seconds, and any single CPU core usage above the CPU usage threshold will report an event log. If a core is reported, that core will not be checked again for the next 30 seconds.  ",
        "audit": "On CLI: config system global  get Ensure that log-single-cpu-high is enabled.  ",
        "recommendations": "On CLI: config system global     set log-single-cpu-high enable end Default Value: Disabled  "
    },
    {
        "title": "2.2.1 Ensure 'Password Policy' is enabled (Automated) ",
        "description": "It is important to use secure and complex passwords for preventing unauthorized access to the FortiGate device.  ",
        "audit": "Currently implemented password policy can be shown from GUI or CLI From CLI, type: get system password-policy  Or from GUI as follows: 1) Log in to FortiGate with a user with at least read-only privileges  2) Go to 'System' > 'Settings' 3) Find and check the status of the 'Password Policy' Section  ",
        "recommendations": "Can be modified from CLI or GUI. From CLI, do the following: Page 49 config system password-policy  set status enable  set apply-to admin-password ipsec-preshared-key  set minimum-length 8  set min-lower-case-letter 1  set min-upper-case-letter 1  set min-non-alphanumeric 1  set min-number 1  set expire-status enable  set expire-day 90  set reuse-password disable end Or from GUI, do the following: 1) Log in to FortiGate as Super Admin 2) Go to 'System' > 'Settings' 3) Find the 'Password Policy' section 4) Default 'Password scope' is 'Off', change it to 'Both' 5) set 'Minimum length' to '8' 6) Enable 'Character requirements' 7) set minimum '1' in the filed of 'Upper Case', 'Lower Case', 'Numbers (0-9)' and 'Special' 8) Disable 'Allow password reuse' 9) Enable 'Password expiration' and set it to 90 Default Value: By default, 'Password Policy' is disabled. It can be checked from CLI as follows: config system password-policy     set status disable end Or from GUI as follows: 1) Log in to FortiGate as Super Admin 2) Go to 'System' > 'Settings' 3) Find the 'Password Policy' section 4) Default 'Password scope' is 'Off'  "
    },
    {
        "title": "2.2.2 Ensure administrator password retries and lockout time are ",
        "description": "Failed login attempts can indicate malicious attempts to gain access to your network. To prevent this security risk, FortiGate is preconfigured to limit the number of failed administrator login attempts. After the maximum number of failed login attempts is reached, access to the account is blocked for the configured lockout period.  ",
        "audit": "To check the lockout options, from CLI: get system global from the output, check the value of the below fields: 1.  admin-lockout-threshold 2.  admin-lockout-duration Ensure that admin-lockout-threshold is set at 3 and admin-lockout-duration is set at 900.  ",
        "recommendations": "To configure the lockout options, from CLI: Page 52 config system global  set admin-lockout-threshold 3  set admin-lockout-duration 900 end Lockout affects the offending IP address, not the entire account. Default Value: By default, the number of password retry attempts is set to three, allowing the administrator a maximum of three attempts at logging in to their account before they are locked out for a set amount of time (by default, 60 seconds).  "
    },
    {
        "title": "2.3.1 Ensure only SNMPv3 is enabled (Automated) ",
        "description": "Ensuring that only SNMPv3 service is enabled and SNMPv1, SNMPv2c are disabled.  ",
        "audit": "From CLI, check to make sure that there is not any community for SNMPv1 or SNMPv2c and only SNMPv3 users are there. Also make sure that SNMP Agent is enabled: Page 55 FGT1 # config system snmp sysinfo FGT1 (sysinfo) # show config system snmp sysinfo  set status enable  ... end FGT1 (sysinfo) # end FGT1 # config system snmp community FGT1 (community) # show config system snmp community end FGT1 (community) # end FGT1 # config system snmp user FGT1 (user) # show config system snmp user     edit \"snmp_test\"         set security-level auth-priv         set auth-proto sha256         set auth-pwd ENC xxxxxx         set priv-proto aes256         set priv-pwd ENC xxxxxx     next end In the GUI, go to: 1. System > SNMP. Make sure that SNMP agent is enabled.   2. Make sure that there is not any SNMPv1/2c community.  3. Make sure that there is at least 1 SNMPv3 user in the list.  ",
        "recommendations": "To enable SNMP agent in CLI: FGT1 # config system snmp sysinfo FGT1 (sysinfo) # set status enable FGT1 (sysinfo) # end In GUI, go to System > SNMP and enable SNMP Agent. To delete SNMPv1/2c communities. In this example, we'll delete community \"public\" in CLI: FGT1 # config system snmp community FGT1 (community) # delete public FGT1 (community) # end FGT # In the GUI, go to: System > SNMP, select the community and click on the Delete button. To add SNMPv3 user in CLI: Page 56 FGT1 # config system snmp user FGT1 (user) # edit \"snmp_test\" FGT1 (snmp_test) # set security-level auth-priv FGT1 (snmp_test) # set auth-proto sha256 FGT1 (snmp_test) # set auth-pwd xxxx FGT1 (snmp_test) # set priv-proto aes256 FGT1 (snmp_test) # set priv_pwd xxxx FGT1 (snmp_test) # end FGT1 # In the GUI, go to: 1. System > SNMP, under SNMPv3, click on \"Create New\" button.  2. Select \"Authentication\" and choose SHA256 as Authentication algorithm. 3. Click \"Change\" to type in the password.  4. Also select option \"Private\", choose AES256 as Encryption Algorithm. 5. Click on \"Change\" to change the password. Click \"OK\" to add the new user. 6. Click apply to apply the new setting into the current config. Default Value: By default, SNMP agent is disabled.  "
    },
    {
        "title": "2.3.2 Allow only trusted hosts in SNMPv3 (Manual) ",
        "description": "Ensuring that only certain hosts are able to conduct SNMP GET or receive SNMP Trap.  ",
        "audit": "From CLI: FGT1 # show system snmp user config system snmp user     edit \"snmp_test\"         set notify-hosts 192.168.1.101         set security-level auth-priv         set auth-proto sha512         set auth-pwd ENC xxxxx         set priv-proto aes256         set priv-pwd ENC xxxxx     next end Validate that \"notify-hosts\" is configured with specific IP address, and there is no \"0.0.0.0\" configured. From GUI: 1. System > SNMP. 2. On SNMPv3 section, double click on the configured SNMPv3 settings. 3. Ensure that \"Hosts\" is configured with specific IP address, and there is no \"0.0.0.0\" configured.  ",
        "recommendations": "To remove 0.0.0.0 from trusted hosts in CLI: FGT1 # config system snmp user FGT1 (user) # edit \"snmp_test\" FGT1 (snmp_test) # unselect notify-hosts 0.0.0.0 FGT1 (snmp_test) # end FGT1 # From GUI: Page 58 1. System > SNMP. 2. On SNMPv3 section, double click on the configured SNMPv3 settings. 3. Remove 0.0.0.0 from \"Hosts\" option. Default Value: By default, no SNMP is configured.  "
    },
    {
        "title": "2.4.1 Ensure default 'admin' password is changed (Manual) ",
        "description": "Before deploying any new FortiGate, it is important to change the password of the default admin account. It is also recommended that you change even the user name of the default admin account, However, since you cannot change the user name of an account that is currently in use, a second administrator account must be created in order to do this.  ",
        "audit": "Using both CLI and GUI, in the username field put in \"admin\", leave the password field blank and proceed. If it's checked out, it means that the default password is still in place and needs to be changed.  ",
        "recommendations": "In the CLI, to change the password of account \"admin\": FG1 # config system admin FG1 (admin) # edit \"admin\" FG1 (admin) # set password <your passwords> FG1 (admin) # end FG1 # To change the default password in the GUI: Page 61 1) Login to FortiGate with admin account 2) Go to System > Administrators. 3) Edit the admin account. 4) Click Change Password. 5) If applicable, enter the current password in the Old Password field. 6) Enter a password in the New Password field, then enter it again in the Confirm Password field. 7) Click OK. Default Value: By default, your FortiGate has an administrator account set up with the username admin and no password. In order to prevent unauthorized access to FortiGate, it is highly recommended that you add a password to this account. Username: admin The default admin account does not have any password. Just leave it blank  "
    },
    {
        "title": "2.4.2 Ensure all the login accounts having specific trusted hosts ",
        "description": "Configure an administrative account to be accessible only to someone who is using a trusted host. You can set a specific IP address for the trusted host or use a subnet.  ",
        "audit": "This example is to check if trusted hosts option is enabled for account \"test_admin\" and which trusted hosts are in the list: FG1 # config system admin FG1 (admin) # edit \"test_admin\" FG1 (test_admin) # show config system admin  edit \"test_admin\"   ...   set trusthost1 10.0.0.0 255.255.255.0   set trusthost2 192.168.10.0 255.255.255.0          ...  next end  In the Web GUI: Page 63 1. System > Administrators. 2. Select the account and click on edit. 3. In the account setting page, make sure that \"Restrict login to trusted hosts\" is enabled and all the allowed hosts / subnets are in the list of trusted host. Please take note that certain versions of FortiOS will only show the first 3 trusted hosts in the list. If you want to see more, you have to click on the \"+\" sign as if you're adding a new item into the list. Keep clicking until you see an empty field of trusted host. That's when you know that you have reached the bottom of the list.  ",
        "recommendations": "To remove a trusted host item from the list in CLI: FG1 # config system admin FG1 (admin) # edit \"test_admin\" FG1 (test_admin) # unset trusthost1 FG1 (test_admin) # end FG1 # To add a trusted host into the list in CLI: FG1 # config system admin FG1 (admin) # edit \"test_admin\" FG1 (test_admin) # set trusthost6 1.1.1.1 255.255.255.255 FG1 (test_admin) # end FG1 # Before adding an item, please make sure that it does not already exist. For example, if trusthost3 is already in the list, using it again will override the existing host/network. In the Web GUI: 1. System > Administrators. 2. select the account and click on edit. 3. In the account setting page, make sure that \"Restrict login to trusted hosts\" is enabled and all the allowed hosts / subnets are in the list of trusted host. Please take note that certain versions of FortiOS will only show the first 3 trusted hosts in the list. If you want to see more, you have to click on the \"+\" sign as if you're adding a new item into the list. Keep clicking until you see an empty field of trusted host. That's when you know that you have reached the bottom of the list. To add another trusted host, fill in the empty field of the new \"Trusted Host\". To remove a trusted host, simply erase everything in the field of that corresponding host. Default Value: By default, each account is accessible from everywhere. The host value is 0.0.0.0/0  "
    },
    {
        "title": "2.4.3 Ensure admin accounts with different privileges have their ",
        "description": "Verify that users with access to the Fortinet should only have the minimum privileges required for that particular user.  ",
        "audit": "There are 2 stages to audit. Here is how to verify in the CLI: Stage 1: Verify the profile. Page 66 FGT1 # config system accprofile FGT1 (accprofile) # edit \"tier_1\" FGT1 (tier_1) # show full config system accprofile     edit \"tier_1\"         set comments ''         set secfabgrp read         set ftviewgrp read         set authgrp none         set sysgrp none         set netgrp read         set loggrp none         set fwgrp custom         set vpngrp none         set utmgrp none         set wifi none         set admintimeout-override disable         config fwgrp-permission             set policy none             set address none             set service none             set schedule none         end     next end FGT1 (tier_1) # If the following privileges are set to \"custom\", please also check the sub-privileges of the customized ones to make sure that only the right privileges are allowed: fwgrp, sysgrp, netgrp, loggrp, utmgrpset. In the GUI, go to: System > Admin Profiles, select the profile and click on \"Edit\". Stage 2: Verify the admin accounts. In the CLI: FGT1 #config system admin FGT1 (admin) # edit \"support1\" FGT1 (support1) # show full config system admin   edit \"support1\"     ...     set accprofile \"tier_1\"     ...   next end In the GUI, go to: Page 67 System > Administrators, select the account and click \"Edit\"  ",
        "recommendations": "In this example, the goal is to provide the profile \"tier_1\" the ability to view and modify address objects. This sub-privilege is under fwgrp privilege. In CLI: FGT1 # config system accprofile FGT1 (accprofile) # edit \"tier_1\" FGT1 (tier_1) # set fwgrp custom FGT1 (tier_1) # config fwgrp-permission FGT1 (fwgrp-permission) # set address read-write FGT1 (fwgrp-permission) # end FGT1 (tier_1) # end FGT1 # For the GUI, go to: 1. System > Admin Profiles, select \"tier_1\" and click \"Edit\".  2. On \"Firewall\", click on \"Custom\". 3. Click on \"Read/Write\" option for \"Address\". In the next example, assign the profile \"tier_1\" to the account \"support1\". In the CLI: FGT1 # config system admin FGT1 (admin) # edit \"support1\" FGT1 (support1) # set accprofile \"tier_1\" FGT1 (support1) # end FGT1 # For the GUI, go to: 1. System > Administrators. 2. Select \"support1\" and click \"Edit\". 3. Under \"Administrator Profile\", select \"tier_1\". Default Value: By default, there are only 2 profiles: prof_admin and super_admin. You must select a profile to create an admin account. The system will not automatically choose for you.  "
    },
    {
        "title": "2.4.4 Ensure idle timeout time is configured (Automated) ",
        "description": "The idle timeout period is the amount of time that an administrator will stay logged in to the GUI without any activity.  ",
        "audit": "To check the idle timeout in the GUI: 1) Login to FortiGate 2) Go to 'System' > 'Settings'. 3) In the 'Administration Settings' section, check the 'Idle timeout' value in minutes. To check the idle timeout in the CLI: get system global check the value of admintimeout in minutes  ",
        "recommendations": "To change the idle timeout in the GUI: 1) Login to FortiGate with Super Admin privileges 2) Go to 'System' > 'Settings'. 3) In the 'Administration Settings' section, set the 'Idle timeout' value to five minutes by typing 5. 4) Click Apply. To change the idle timeout in the CLI: Page 70 config system global  set admintimeout 5 end Default Value: By default, it is set to five minutes.  "
    },
    {
        "title": "2.4.5 Ensure only encrypted access channels are enabled ",
        "description": "Allow only HTTPS access to the GUI and SSH access to the CLI.  ",
        "audit": "In the CLI, when verifying the network interface, make sure that http and telnet are not in the allowaccess list: FG1 # config system interface FG1 (interface) # edit port1 FG1 (port1) # show config system interface  edit \"port1\"   ...   set allowaccess ssh https ping snmp   ...  next end In the web GUI, click on: 1. Network > Interfaces, select the interface and click \"Edit\".  2. In the interface setting page, make sure that HTTP and Telnet are not selected in the section \"Administrative Access\"  ",
        "recommendations": "If HTTP or Telnet is in the allowaccess list, you will have to set that list again with the same elements except for http or telnet. On CLI: FG1 # config system interface FG1 (interface) # edit port1 FG1 (port1) # set allowaccess ssh https ping snmp FG1 (port1) # end FG1 # In the web GUI, click on: Page 72 1. Network > Interfaces, select the interface and click \"Edit\".  2. In the interface setting page, uncheck HTTP and Telnet in the section \"Administrative Access\". Default Value: By default, HTTP and Telnet are not enabled on any interface.  "
    },
    {
        "title": "2.4.6 Apply Local-in Policies (Manual) ",
        "description": "Configure Local-in Policies to control inbound traffic that is destined to a FortiGate interface.  ",
        "audit": "To review Local-in Policies in the GUI, go to: 1. System > Feature Visibility. 2. Turning on \"Local-in policies\" under the Additional Features Section. This will then add the section under \"Policies and Objects\" there will now be a section for \"Local-in Policies\" It can also be viewed through the CLI: config firewall local-in-policy  show  ",
        "recommendations": "Local-in Policies can only be configured through the CLI: Page 74 config firewall {local-in-policy | local-in-policy6}     edit <policy_number>         set intf <interface>         set srcaddr <source_address> [source_address] ...         set dstaddr <destination_address> [destination_address] ...         set action {accept | deny}         set service <service_name> [service_name] ...         set schedule <schedule_name>         set comments <string>     next end For example, to prevent the source subnet 10.10.10.0/24 from pinging port1, but allow administrative access for PING on port1: config firewall address     edit \"10.10.10.0\"         set subnet 10.10.10.0 255.255.255.0     next end config firewall local-in-policy     edit 1         set intf \"port1\"         set srcaddr \"10.10.10.0\"         set dstaddr \"all\"         set service \"PING\"         set schedule \"always\"     next end Default Value: There are no Local-in Policies in place by default.  "
    },
    {
        "title": "2.4.7 Ensure default Admin ports are changed (Manual) ",
        "description": "FortiGate admin ports listen on the common ports of 80 and 443. This is default behavior. While interface access is controlled by configuring network interfaces, the FortiGate still listens on the admin ports that have been configured, which can also cause a conflict should 80 or 443 be needed as part of additional configuration later on.  ",
        "audit": "Log in to the GUI and click on System > Settings > Review the ports under 'Administration Settings' section.  ",
        "recommendations": "config system global     set admin-https-redirect disable     set admin-port 8082 **(or any other uncommon port)**     set admin-server-cert \"self-sign\"     set admin-sport 4343 **(or any other uncommon port)** end OR From Web GUI: 1. System > Settings 2. Change the ports/settings under 'Administration Settings' section. NOTE: https redirection must be turned off as well as changing port 80. This is due to the nature of how browser port redirection works. The browser will be redirected from port 80 to port 443 or whichever 'admin-sport' is configured, meaning that it will still listen on port 80 even when the port has been reconfigured. Page 77 Default Value: config system global     set admin-https-redirect enable     set admin-port 80     set admin-server-cert \"self-sign\"     set admin-sport 443  "
    },
    {
        "title": "2.4.8 Virtual patching on the local-in management interface ",
        "description": "Allow virtual patching to be applied to traffic destined to the FortiGate by applying IPS signatures to the local in interface using local in policies. Attacks geared towards GUI and SSH management access, for example, can be mitigated using IPS signatures pushed from FortiGuard, thereby virtually patching these vulnerabilities.  ",
        "audit": "On CLI: config firewall local-in-policy  show Ensure that virtual-patch is enabled for those policy that is allowing traffic.  ",
        "recommendations": "On CLI: config firewall local-in-policy      edit <id>         set virtual-patch enable     next end Default Value: Disabled  "
    },
    {
        "title": "2.5.1 Ensure High Availability configuration is enabled ",
        "description": "Ensure that FortiGate devices are configured for High Availability (HA).  ",
        "audit": "In GUI: 1. Navigate to \"System\" and then \"HA\" 2. Ensure \"Mode\" is set to proper setting \"Active-Active\" or \"Active-Passive\" 3. Review Configuration settings:  - \"Cluster Name\" must match on devices  - \"Password\" Must match on devices  - \"Heartbeat Interfaces\" need to be defined on devices 4. Click \"OK\" to save changes and exit In CLI: FGT1 # config system ha  FGT1 (ha) # set mode a-p        ###(Active-Passive) FGT1 (ha) # set group-name \"FGT-HA\"            ###(Set cluster name) FGT1 (ha) # set password *******   ###(Set password)  FGT1 (ha) # set hbdev port10 50   ###(Set Heartbeat Interface and priority) FGT1 (ha) # end To review configuration in CLI: Page 82 FGT1 # config system ha FGT1 (ha) # show config system ha     set group-name \"FGT-HA\"     set mode a-p     set password ENC enrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgoprYMvh6w7F06+nRriBtMNQxpOV5V+e388EcwsOOMsXBZOw==     set hbdev \"port10\" 50      set override disable end  ",
        "recommendations": "In GUI: 1. Navigate to \"System\" and then \"HA\" 2. Ensure \"Mode\" is set to proper setting \"Active-Active\" or \"Active-Passive\" 3. Review Configuration settings:  - \"Cluster Name\" must match on devices  - \"Password\" Must match on devices  - \"Heartbeat Interfaces\" need to be defined on devices 4. Click \"OK\" to save changes and exit In CLI: FGT1 # config system ha  FGT1 (ha) # set mode a-p        ###(Active-Passive) FGT1 (ha) # set group-name \"FGT-HA\"            ###(Set cluster name) FGT1 (ha) # set password *******   ###(Set password)  FGT1 (ha) # set hbdev port10 50   ###(Set Heartbeat Interface and priority) FGT1 (ha) # end To review configuration in CLI: FGT1 # config system ha FGT1 (ha) # show config system ha     set group-name \"FGT-HA\"     set mode a-p     set password ENC enrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgoprYMvh6w7F06+nRriBtMNQxpOV5V+e388EcwsOOMsXBZOw==     set hbdev \"port10\" 50      set override disable end Default Value: N/A Page 83  "
    },
    {
        "title": "2.5.2 Ensure \"Monitor Interfaces\" for High Availability devices is ",
        "description": "Configure Interface Monitoring within High Availability settings. Interface Monitoring should be enabled on all critical interfaces.  ",
        "audit": "To validate from GUI: 1. Go to System > HA. 2. Under \"Monitor Interfaces\" validate all applicable interfaces are selected. 3. Select \"OK\". To validate from CLI: FGT1 # config system ha FGT1 (ha) # show config system ha     set group-name \"FGT-HA\"     set mode a-p     set password ENC enrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgoprYMvh6w7F06+nRriBtMNQxpiTE+12xAHz7lA3EoYZzf8A==     set override disable     set monitor \"port6\" \"port7\"   ###Validate proper interfaces are present end  ",
        "recommendations": "To remediate from GUI: Page 85 1. Go to System > HA. 2. Under \"Monitor Interfaces\" select all applicable interfaces. 3. Select \"OK\". To validate from CLI: FGT1 # config system ha FGT1 (ha) # set monitor \"port6\" \"port7\" FGT1 (ha) # show  ###To Review changes to monitored interfaces before applying config system ha     set group-name \"FGT-HA\"     set mode a-p     set password ENC enrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgoprYMvh6w7F06+nRriBtMNQxpiTE+12xAHz7lA3EoYZzf8A==     set override disable     set monitor \"port6\" \"port7\"    end Default Value: N/A  "
    },
    {
        "title": "2.5.3 Ensure HA Reserved Management Interface is configured ",
        "description": "Ensure Reserved Management Interfaces are configured on HA devices.  ",
        "audit": "Review through the GUI: 1. Go to System > HA edit the \"Master\" device. 2. Verify that \"Management Interface Reservation\" is selected and there is an interface, and gateway defined. Review through the CLI: FGT1 #config system ha FGT1 (ha) # show config system ha     set group-name \"FGT-HA\"     set mode a-p     set password ENC enrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgoprYMvh6w7F06+nRriBtMNQxpiTE+12xAHz7lA3EoYZzf8A==     set ha-mgmt-status enable       config ha-mgmt-interfaces         edit 1             set interface \"port6\"             set gateway 10.10.10.1         next     end     set override disable end Validate that set ha-mgmt-status is enabled and that config ha-mgmt-interfaces has at least one entry with an interface and gateway defined. Page 87  ",
        "recommendations": "Remediate through the GUI: 1. Go to System > HA edit the \"Master\" device. 2. Enable \"Management Interface Reservation\" once this is enabled select an an interface, and configure the appropriate gateway. Remediate through the CLI: FGT1 #config system ha FGT1 (ha) # set ha-mgmt-status enable  FGT1 (ha) # config ha-mgmt-interfaces  FGT1 (ha-mgmt-interfaces) # edit 1 new entry '1' added FGT1 (1) # set interface port6 FGT1 (1) # set gateway 10.10.10.1 FGT1 (1) # end FGT1 (ha) # show config system ha     set group-name \"FGT-HA\"     set mode a-p     set password ENC enrwD467hJmO6j6YW/l6FEOa1YNVYdo8Z5mCcTDEKUFpOVXcNYnPBmQDGX//ViXk6TkwNH0il5aJr/fZY25lq+husndQHZVWp2LIlXmCv/n81U43nkZUWaIKvqkellGFbhv0/IHoOLzQPCsVcBbyrsgoprYMvh6w7F06+nRriBtMNQxpiTE+12xAHz7lA3EoYZzf8A==     set ha-mgmt-status enable       config ha-mgmt-interfaces         edit 1             set interface \"port6\"             set gateway 10.10.10.1         next     end     set override disable end FGT1 (ha) # end Default Value: N/A  "
    },
    {
        "title": "3.1 Ensure that unused policies are reviewed regularly (Manual) ",
        "description": "All firewall policies should be reviewed regularly to verify the business purpose. Unused policies should be disabled and logged. Recommendation to review twice per year or inline with BCP practice (Business Continuity Plan). Some of the firewall policies will only be used during BCP, hence, the hit count might show 0 if the review is done too often.  ",
        "audit": "In CLI, type \"diag firewall iprope show 100004 <policy_id>\". In this example, we'll verify policy with ID of 32. We'll also need to clear the counter after each review so that we can tell if the policy is still being used for the next review : FGT1 # diag firewall iprope show 100004 32 idx=2 pkts/bytes=144967/135758174 asic_pkts/asic_bytes=0/0 flag=0x0 hit count:663 FGT1 # diag firewall iprope clear 100004 32 In the GUI, 1. Go to Policy & Objects. 2. Click on Firewall Policy.  3. Make sure that either the columns \"Bytes\" or \"Hit Count\" are visible. To display either one of them, move the cursor to the top row where all the columns names are. Right click and select \"Bytes\" or \"Hit Count\" and click OK. To clear the counter, right click on the \"Bytes\" or \"Hit Count\" columns of that policy and click on \"Clear Counters\".  ",
        "recommendations": "The remediation is to review and decide if you should delete unused policies. Default Value: By default, the hit count value is 0 at the beginning.  "
    },
    {
        "title": "3.2 Ensure that policies do not use \"ALL\" as Service (Automated) ",
        "description": "Ensure that all security policies in effect clearly state which protocols / services they are allowing.  ",
        "audit": "In CLI: FGT1 # config firewall policy FGT1 (policy) # show TEST-FG-Third (policy) # show config firewall policy     edit 1         set uuid d0eed832-bb73-51e6-c3da-3cd2ec201608         set srcintf \"internal\"         set dstintf \"wan\"         set srcaddr \"all\"         set dstaddr \"all\"         set action accept         set schedule \"always\"         set service \"HTTPS\" \"HTTP\"         set ssl-ssh-profile \"__tmp_no-inspection\"         set nat enable     next end In the GUI, 1. Go to Policy & Objects. 2. Click on Firewall Policy. Make sure that none of the policies use \"ALL\" as its service.  ",
        "recommendations": "This is an example showing how to modify policy with ID of 2 to change the service from \"ALL\" to FTP and SNMP. In CLI: Page 93 FGT1 # config firewall policy FGT1 (policy) # edit 2 FGT1 (2) # set service \"FTP\" \"SNMP\" FGT1 (2) # end FGT1 # In the GUI, 1. Go to Policy & Objects. 2. Click on Firewall Policy. 3. Select the policy, click \"Edit\". 4. In the Service section, click on it and select FTP and SNMP. Click OK. Default Value: By default, all new policy will have \"ALL\" in its service field.  "
    },
    {
        "title": "3.3 Ensure firewall policy denying all traffic to/from Tor, malicious ",
        "description": "Firewall policies should include a deny rule for traffic going to/from Tor, malicious server, or scanner IP addresses using ISDB (Internet Service Database).  ",
        "audit": "Go to \"Policy & Objects\". Validate that there is a firewall policy created to block inbound connections from sources named \"Tor-Exit.Node\", \"Tor-Relay.Node\", \"Censys-Scanner\", \"Shodan-Scanner\", \"Botnet-C&C.Server\", \"Phishing-Phishing.Server\", \"Proxy-Proxy.Server\", \"Spam-Spamming.Server\", \"VPN-Anonymous.VPN\", and \"Malicious-Malicious.Server\" on \"All\" services. Validate that there is a firewall policy created to block outbound connections to destination named \"Tor-Relay.Node\", \"Botnet-C&C.Server\", \"Phishing-Phishing.Server\", \"Proxy-Proxy.Server\", \"Spam-Spamming.Server\", \"VPN-Anonymous.VPN\", and \"Malicious-Malicious.Server\".  ",
        "recommendations": "Review firewall policies and ensure there are: 1. A firewall policy created to block inbound connections with these settings: Page 95 From: Any To: Any Source: \"Tor-Exit.Node\", \"Tor-Relay.Node\", \"Censys-Scanner\", \"Shodan-Scanner\", \"Botnet-C&C.Server\", \"Phishing-Phishing.Server\", \"Proxy-Proxy.Server\", \"Spam-Spamming.Server\", \"VPN-Anonymous.VPN\", and \"Malicious-Malicious.Server\" Destination: all Schedule: Always Services: All Action: Deny Log Violation Traffic: Enabled Enable this policy: Enabled 2. A firewall policy created to block outbound connections with these settings: From: Any To: Any Source: All Destination: \"Tor-Relay.Node\", \"Botnet-C&C.Server\", \"Phishing-Phishing.Server\", \"Proxy-Proxy.Server\", \"Spam-Spamming.Server\", \"VPN-Anonymous.VPN\", and \"Malicious-Malicious.Server\" Schedule: Always Action: Deny Log Violation Traffic: Enabled Enable this policy: Enabled  "
    },
    {
        "title": "3.4 Ensure logging is enabled on all firewall policies (Manual) ",
        "description": "Logging should be enabled for all firewall policies including the default implicit deny policy.  ",
        "audit": "Go to \"Policy & Objects\" > \"Firewall Policy\". Validate that logging is enabled on all firewall policies.  ",
        "recommendations": "Review firewall policies and ensure that: 1. For allowed policies, \"Log Allowed Traffic\" is set on \"All Sessions\" option. 2. For denied policies, \"Log Violation Traffic\" is enabled. Default Value: Logging is disabled. Page 98  "
    },
    {
        "title": "4.1.1 Detect Botnet connections (Manual) ",
        "description": "Interfaces which are classified as \"WAN\" and are used by a policy should use an IPS sensor which blocks or monitors outgoing connections to botnet sites.  ",
        "audit": "On GUI: 1. Ensure that relevant IPS profile is configured with \"Scan Outgoing Connections to Botnet Sites\" set to \"Block\". 2. Review all firewall policies that have a \"WAN\" interface as the destination.  ",
        "recommendations": "On GUI: 1. Configure relevant IPS profiles with \"Scan Outgoing Connections to Botnet Sites\" set to \"Block\". 2. Apply relevant IPS profile on all firewall policies with traffic exiting the network to a \"WAN\" interface. Default Value: \"Scan Outgoing Connections to Botnet Sites\" is disabled on default profile.  "
    },
    {
        "title": "4.1.2 Apply IPS Security Profile to Policies (Manual) ",
        "description": "Ensuring that traffic traversing between networks on the FortiGate have an IPS security profile inspecting it.  ",
        "audit": "Review all firewall policies and ensure that traffic has an IPS security profile assigned for inspection.  ",
        "recommendations": "Configure on all \"Allowed\" firewall policies to have an appropriate IPS security profile applied to policies. Default Value: Not Configured  "
    },
    {
        "title": "4.2.1 Ensure Antivirus Definition Push Updates are Configured ",
        "description": "Ensure FortiGate is configured to accept antivirus definition push updates.  ",
        "audit": "On GUI: 1. Access the FortiGate administrative web access page and go to System > FortiGuard. 2. Under \"FortiGuard Updates\" ensure that the \"Scheduled updates\" is set to \"Automatic\". On CLI: config system autoupdate schedule show (Validate that there are no output, meaning it is already set as \"automatic\"  ",
        "recommendations": "On GUI: 1. Access the FortiGate administrative web access page and go to System > FortiGuard. 2. Under \"FortiGuard Updates\" ensure that the \"Scheduled updates\" is set to \"Automatic\".  On CLI: config system autoupdate schedule set status enable set frequency automatic end Default Value: Enabled and set to automatic. Page 106  "
    },
    {
        "title": "4.2.2 Apply Antivirus Security Profile to Policies (Manual) ",
        "description": "Ensuring that traffic traversing between networks on the FortiGate has an Antivirus Security profile inspecting it.  ",
        "audit": "Review all firewall policies and ensure that traffic has an antivirus security profile assigned for inspection.  ",
        "recommendations": "Review firewall policies and apply an appropriate antivirus security profile to policies. Default Value: No security inspection on firewall policies.  "
    },
    {
        "title": "4.2.3 Enable Outbreak Prevention Database (Automated) ",
        "description": "Ensure FortiGate AV inspection uses outbreak prevention database as an added layer of protection on top of antivirus' signature-based detection.  ",
        "audit": "On GUI: 1. Go to \"Security Profiles\" > \"AntiVirus\". 2. Select AV profile. Validate that \"Use FortiGuard outbreak prevention database\" is enabled. On CLI: FGT1 # config antivirus profile FGT1 (profile) # show Validate that for each traffic protocol, \"set outbreak-prevention block\" is configured.  ",
        "recommendations": "Review Antivirus Security Profiles and validate that \"Use FortiGuard outbreak prevention database\" is enabled. Default Value: Disabled  "
    },
    {
        "title": "4.2.4 Enable AI /heuristic based malware detection (Automated) ",
        "description": "AI /heuristic based detection should be enabled.  ",
        "audit": "Configuration and verification can be only done on CLI. On CLI: FGT1 # show antivirus settings | grep machine-learning-detection Validate that it is enabled.  ",
        "recommendations": "On CLI: FGT1 # config antivirus settings FGT1 (settings) # set machine-learning-detection enable Default Value: Enabled.  "
    },
    {
        "title": "4.2.5 Enable grayware detection on antivirus (Automated) ",
        "description": "Grayware detection should be enabled.  ",
        "audit": "CLI: FGT1 # show antivirus settings | grep grayware Validate that grayware detection is enabled.  ",
        "recommendations": "On CLI: FGT1 # config antivirus settings FGT1 (settings) # set grayware enable Default Value: Disabled  "
    },
    {
        "title": "4.2.6 Ensure inline scanning with FortiGuard AI-Based Sandbox ",
        "description": "Inline scanning is supported when the FortiGate is licensed with the FortiGuard AI-Based Sandbox Service (FAIS). It works similar to inline scanning for the FortiSandbox appliance, by holding a file up to 50 seconds for the verdict to be returned. Timed out scans can either be set to block, log, or ignore. Inline scanning can be enabled from the GUI on the Cloud Sandbox configuration page.  ",
        "audit": "On CLI: config system fortiguard get Verify if sandbox-inline-scan is enabled. Note that, sandbox-inline-scan will only show up after sandbox region is set (this is done during initial setup). If there is no sandbox-inline-scan in the output, it means that this feature is not enabled. If sandbox-inline-scan is enabled, check on CLI if it is enforced on AV security profile: config antivirus profile show Verify if fortisandbox-mode inline is set and on each traffic protocol, fortisandbox block is set. On GUI: 1. Go to Security Fabric > Fabric Connectors and double-click the Cloud Sandbox card. Verify if \"Inline scan\" is enabled. If \"Inline scan\" is enabled, then: 1. Go to Security Profiles > AntiVirus and double-click the relevant AV profile. Verify if Scan strategy is set as \"Inline\" and Action is set as \"Block\" Page 115  ",
        "recommendations": "On GUI: Enable the FortiGate Cloud feature visibility: 1. Go to System > Feature Visibility. 2. In the Additional Features section, enable FortiGate Cloud Sandbox. 3. Click Apply. Configure the Cloud Sandbox Fabric connector: 1. Go to Security Fabric > Fabric Connectors and double-click the Cloud Sandbox card. 2. Set the Type to FortiGate Cloud. 3. Select a Region. 4. Enable Inline scan. 5. Click OK. Configure the antivirus profile: 1. Go to Security Profiles > AntiVirus and click Create New. 2. Set the Feature set to Proxy-based. 3. Enable the protocols to inspect. 4. Enable Send files to FortiSandbox for inspection. 5. Set the Scan strategy to Inline, and set the Action to Block. 6. Click OK. On CLI: Disable FortiSandbox appliance and FortiSandbox Cloud: config system fortisandbox      set status disable  end Configure FortiGate Cloud Sandbox (example given is setting it as \"Global\" region): # execute forticloud-sandbox region  0  Global 1  Europe 2  Japan 3  US Please select cloud sandbox region[0-3]:0 Cloud sandbox region is selected: Global Enable inline scanning for FortiGate Cloud: Page 116 config system fortiguard     set sandbox-region \"Global\"     set sandbox-inline-scan enable end Enforced on AV security profile: config antivirus profile edit  set feature-set proxy set fortisandbox-mode inline config http set fortisandbox block end config ftp set fortisandbox block end config imap set fortisandbox block ..... end Default Value: Disabled  "
    },
    {
        "title": "4.3.1 Enable Botnet C&C Domain Blocking DNS Filter ",
        "description": "Enable Botnet C&C domain blocking to block botnet access at the DNS name resolving stage.  ",
        "audit": "On GUI: 1. Review DNS filters under Security Profiles > DNS Filter and ensure that \"Redirect botnet C&C requests to Block Portal\" is enabled. 2. Ensure that firewall policies allowing DNS traffic have a DNS Filter Security profile applied.  ",
        "recommendations": "On GUI: 1. Go to Security Profiles > DNS Filter. 2. On the relevant security profile name, double click. Enable \"Redirect botnet C&C requests to Block Portal\". 2. Ensure that firewall policies that have DNS traffic have a DNS Filter security profile applied with that option enabled. Default Value: \"Redirect botnet C&C requests to Block Portal\" is enabled on default profile.  "
    },
    {
        "title": "4.3.2 Ensure DNS Filter logs all DNS queries and responses ",
        "description": "DNS filter should log all DNS queries and responses.  ",
        "audit": "GUI: 1. Go to \"Security Profiles\" > \"DNS Filter\". 2. Select relevant DNS Filter profile. Validate that \"Log all DNS queries and responses\" is enabled. CLI: FGT1 # config dnsfilter profile FGT1 (profile) # show Validate that \"set log-all-domain enable\" is configured on DNS Filter profile.  ",
        "recommendations": "Review DNS Filter Security Profiles and validate that \"Log all DNS queries and responses\" is enabled. Default Value: Disabled Page 121  "
    },
    {
        "title": "4.3.3 Apply DNS Filter Security Profile to Policies (Manual) ",
        "description": "Ensuring that traffic traversing to the Internet on the FortiGate has a DNS Filter security profile inspecting it.  ",
        "audit": "Review firewall policies that handle traffic outbound to Internet has an DNS Filter security profile assigned for inspection.  ",
        "recommendations": "Configure on \"Allowed\" firewall policies that handle traffic outbound to Internet to have an appropriate DNS Filter security profile applied to policies. Default Value: Not Configured  "
    },
    {
        "title": "4.4.1 Block high risk categories on Application Control (Manual) ",
        "description": "Ensure FortiGate Application Control blocks high risk applications to reduce attack surface.  ",
        "audit": "GUI: 1. Go to \"Security Profiles\" > \"Application Control\". 2. Select App Control profile. Validate that \"P2P\" and \"Proxy\" category is blocked.  ",
        "recommendations": "Review Application Control Security Profiles and validate that \"P2P\" and \"Proxy\" category is blocked. Default Value: All application category \"Action\" is set as \"Monitor\" by default.  "
    },
    {
        "title": "4.4.2 Block applications running on non-default ports (Automated) ",
        "description": "Ensure FortiGate Application Control blocks applications running on non-default ports.  ",
        "audit": "On GUI: 1. Go to \"Security Profiles\" > \"Application Control\". 2. Select relevant App Control profile. Validate that \"Block applications detected on non-default ports\" option is enabled.  ",
        "recommendations": "GUI: 1. Go to \"Security Profiles\" > \"Application Control\". 2. Select relevant App Control profile. Enable \"Block applications detected on non-default ports\" option. On CLI: FGT1 # config application list FGT1 (list) # edit <profile name> FGT1 (<profile name>) # set enforce-default-app-port enable Default Value: Disabled  "
    },
    {
        "title": "4.4.3 Ensure all Application Control related traffic is logged ",
        "description": "Ensure no category is set to \"Allow\" on FortiGate Application Control.  ",
        "audit": "On GUI: 1. Review \"Security Profiles\" > \"Application Control\". 2. Select the relevant App Control profile. Validate that no \"Allow\" action is set on any categories.  ",
        "recommendations": "On GUI: 1. Go to \"Security Profiles\" > \"Application Control\". 2. Select the relevant App Control profile. 3. Change any categories with \"Allow\" action to \"Monitor\". Default Value: \"Unknown Applications\" category is set as \"Allow\".  "
    },
    {
        "title": "4.4.4 Apply Application Control Security Profile to Policies ",
        "description": "Ensuring that traffic traversing between networks on the FortiGate have an Application Control security profile inspecting it.  ",
        "audit": "Review all firewall policies and ensure that traffic has an Application Control security profile assigned for inspection.  ",
        "recommendations": "Configure on all \"Allowed\" firewall policies to have an appropriate Application Control security profile applied to policies. Default Value: Not Configured  "
    },
    {
        "title": "5.1.1 Enable Compromised Host Quarantine (Automated) ",
        "description": "Default automation trigger configuration for when a high severity compromised host is detected.  ",
        "audit": "GUI Security Fabric > Automation Verify Compromised Host Quarantine is enabled.  ",
        "recommendations": "GUI Security Fabric > Automation Edit and change Disabled to Enabled CLI Page 135 config system automation-action     edit \"Quarantine on FortiSwitch + FortiAP\"         set description \"Default automation action configuration for quarantining a MAC address on FortiSwitches and FortiAPs.\"         set action-type quarantine     next     edit \"Quarantine FortiClient EMS Endpoint\"         set description \"Default automation action configuration for quarantining a FortiClient EMS endpoint device.\"         set action-type quarantine-forticlient     next end config system automation-trigger     edit \"Compromised Host - High\"         set description \"Default automation trigger configuration for when a high severity compromised host is detected.\"     next end config system automation-stitch     edit \"Compromised Host Quarantine\"         set description \"Default automation stitch to quarantine a high severity compromised host on FortiAPs, FortiSwitches, and FortiClient EMS.\"         set status enable         set trigger \"Compromised Host - High\"         config actions             edit 1                 set action \"Quarantine on FortiSwitch + FortiAP\"             next             edit 2                 set action \"Quarantine FortiClient EMS Endpoint\"             next         end     next end Default Value: Not enabled  "
    },
    {
        "title": "5.2.1.1 Ensure Security Fabric is Configured (Automated) ",
        "description": "Ensure Root FortiGate is configured as security fabric root.  ",
        "audit": "Review through the GUI: 1. Go to \"Security Fabric\" -> Fabric Connectors and then select \"Security Fabric Setup\". 2. Validate that the root FortiGate has status set to enabled and the Security Fabric Role set to \"Serve as Fabric Root\". 3. Ensure that FortiAnalyzer settings are correct and that there is a defined Fabric name as well as interfaces selected that will \"Allow other Security Fabric Devices to Join\".  ",
        "recommendations": "Remediation through the GUI: 1. Go to \"Security Fabric\" -> Fabric Connectors and then select \"Security Fabric Setup\".  2. On the root FortiGate, set the status to enabled and the Security Fabric Role to \"Serve as Fabric Root\". 3. Configure FortiAnalyzer settings when prompted and define a Fabric name as well as interfaces that will \"Allow other Security Fabric Devices to Join\". Default Value: Disabled Page 140  "
    },
    {
        "title": "6.1.1 Apply a Trusted Signed Certificate for VPN Portal (Manual) ",
        "description": "Apply a signed certificate from a trusted Certificate Authority (CA) to the SSL VPN portal to allow users to connect securely with confidence.  ",
        "audit": "GUI: 1. Access the FortiGate administrative web access page. 2. Go to VPN > SSL-VPN Settings and assign a signed certificate in the dropdown for \"Server Certificate\".  ",
        "recommendations": "Import a signed certificate from a trusted CA through the GUI: 1. Go to System > Certificates > Import. 2. Then assign the certificate to the SSL VPN portal by going to VPN > SSL-VPN Settings and selecting the proper certificate in the dropdown for \"Server Certificate\". Default Value: Self Signed Factory installed certificate  "
    },
    {
        "title": "6.1.2 Enable Limited TLS Versions for SSL VPN (Manual) ",
        "description": "Enable and disable TLS versions and Cipher suites for more granular control of SSL VPN connections and enforcing more secure connections.  ",
        "audit": "CLI: config vpn ssl settings get Validate that: ssl-max-prot-ver is set to tls1-3. ssl-min-proto-ver is set to tls1-2. algorithm is set to high.  ",
        "recommendations": "CLI: config vpn ssl settings set ssl-max-prot-ver tls1-3 set ssl-min-proto ver tls1-2 set algorithm high Default Value: ssl-max-proto-ver : tls1-3 ssl-min-proto-ver : tls1-2 algorithm : high  "
    },
    {
        "title": "7.1.1 Enable Event Logging (Automated) ",
        "description": "Enabling event logging to allow for log generation and review.  ",
        "audit": "CLI: config log eventfilter get Validate that all event types are enabled.  ",
        "recommendations": "On GUI: 1. Go to Log & Report > Log Settings. 2. Enable \"All\" Event Logging. On CLI: config log eventfilter set event enable end Default Value: Enabled  "
    },
    {
        "title": "7.2.1 Encrypt Log Transmission to FortiAnalyzer / FortiManager ",
        "description": "Enable encryption for logs that are sent to FortiAnalyzer or FortiManager.  ",
        "audit": "CLI: config log fortianalyzer setting get Validate enc-algorithm is set to high. Validate reliable is set enabled.  ",
        "recommendations": "Secure log transfer settings can only be configured on CLI: config log fortianalyzer setting set reliable enable set enc-algorithm high end Default Value: Disabled  "
    },
    {
        "title": "7.3.1 Centralized Logging and Reporting (Automated) ",
        "description": "Device logs should be sent to a centralized device for log collection, retention, and reporting. This could be a SIEM. syslog device, FortiAnalyzer, FortiManager, etc.  ",
        "audit": "On GUI: 1. Go to Log & Report > Log Settings. 2. Validate under \"Syslog logging\" that logs are being offloaded to another device.  ",
        "recommendations": "Configure a remote server for logs to be sent to: 1. Go to Log & Report > Log Settings. 2. Under \"Syslog logging\" configure a remote server to send logs to. Default Value: Not configured.  "
    }
]